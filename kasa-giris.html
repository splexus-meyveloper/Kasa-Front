<!-- PAGE HEADING -->
<div class="row justify-content-between align-items-center mb-10">
    <div class="col-12 col-lg-auto mb-20">
        <div class="page-heading">
            <h3>Kasa <span>/ Nakit Giriş</span></h3>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="box">
            <div class="box-head">
                <h3 class="title">Kasa Nakit Giriş</h3>
            </div>
            <div class="box-body">
                <form>

                    <div class="row">

                        <div class="col-md-6 mb-20">
                        <label>Tutar (₺)</label>
                        <input 
                           type="text"
                           id="tutar"
                           class="form-control"
                           placeholder="0,00"
                           inputmode="numeric"
                           autocomplete="off"
                         >
                         </div>


                        <div class="col-md-12 mb-20">
                            <label>Açıklama</label>
                            <textarea id="aciklama" class="form-control" placeholder="Açıklama"></textarea>
                        </div>

                        <div class="col-12">
                            <button type="button" id="btnKasaGiris" class="button button-primary">
                            Kaydet
                            </button>

                        </div>

                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<script>
const input = document.getElementById("tutar");

function formatCurrency(value) {
    value = value.replace(/[^0-9,]/g, "");

    const parts = value.split(",");
    if (parts.length > 2) {
        value = parts[0] + "," + parts.slice(1).join("");
    }

    let [integerPart, decimalPart] = value.split(",");

    integerPart = integerPart.replace(/\./g, "");
    integerPart = integerPart.replace(/\B(?=(\d{3})+(?!\d))/g, ".");

    if (decimalPart !== undefined) {
        decimalPart = decimalPart.substring(0, 2);
        return integerPart + "," + decimalPart + " TL";
    } else {
        return integerPart + " TL";
    }
}

if (input) {
    input.addEventListener("input", function () {
        const start = this.selectionStart;
        const oldLength = this.value.length;

        this.value = formatCurrency(this.value.replace(" TL", ""));

        const diff = this.value.length - oldLength;
        this.setSelectionRange(start + diff, start + diff);
    });

    input.addEventListener("blur", function () {
        let val = this.value.replace(" TL", "").replace(/\./g, "").replace(",", ".");
        if (!val) return;

        let num = parseFloat(val);
        if (isNaN(num)) {
            this.value = "";
            return;
        }

        this.value = num.toLocaleString("tr-TR", {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
        }) + " TL";
    });
}
</script>

<script src="assets/js/kasa-app-v2.js"></script>
